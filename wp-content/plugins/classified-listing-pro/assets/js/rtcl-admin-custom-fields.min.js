!function(t){"use strict";t(function(){n(),o()});var e=t("body");function o(){jQuery(document).on("blur focus click",".js-rtcl-slugize",function(){var t=jQuery(this).val();if(""==t&&(t=jQuery(".js-rtcl-slugize-source",jQuery(this).closest(".postbox")).val()),""!=t){var e=function(t){if("string"!=typeof t||""==t)return;return t=(t=(t=(t=(t=t.toLowerCase()).replace(/[^a-z0-9A-Z_]+/g,"-")).replace(/\-+/g,"-")).replace(/^\-/g,"")).replace(/\-$/g,"")}(t);e==t&&""!=jQuery(this).val()||jQuery(this).val(e.substring(0,200))}})}function n(){t("#rtcl-cfg").sortable({cursor:"ns-resize",axis:"y",handle:"h2.hndle",forcePlaceholderSize:!0,tolerance:"pointer",start:function(t,e){e.placeholder.height(e.item.height()+23)}})}t(document).on("click","#rtcl-cf-add-new",function(e){e.preventDefault();var l=t(this),i=t('<div style="display:none;height:450px;" class="rtcl-choose-field">'+l.data("message-loading")+"</div>").appendTo("body");function r(e){var l;t("#post-body-content #rtcl-cfg").append(e),l=t("#post-body-content #rtcl-cfg .postbox").last(),t("html, body").animate({scrollTop:l.offset().top-50},1e3),i.dialog("close"),o(),t(".postbox .hndle, .postbox .handlediv").unbind("click.postboxes"),postboxes.add_postbox_toggles(),l.typesFieldOptionsSortable(),l.typesMarkExistingField(),n()}return i.dialog({close:function(t,e){i.remove()},closeText:!1,modal:!0,minWidth:810,maxHeight:.9*t(window).height(),title:l.data("dialog-title"),position:{my:"center top+50",at:"center top",of:window}}),i.load(ajaxurl,{action:"rtcl_edit_field_choose"},function(e,o,n){t(this).closest(".ui-dialog-content");t(i).on("click","span.rtcl-field-button-insert",function(){var e=t(this),o=e.data("type");t.ajax({url:ajaxurl,method:"POST",data:{action:"rtcl_edit_field_insert",type:o,id:parseInt(t("#post_ID").val(),10),__rtcl_wpnonce:rtcl_cfg.__rtcl_wpnonce},beforeSend:function(){e.rtclBlock()},success:function(t){e.rtclUnblock(),t.error?alert(t.msg):r(t.data)},error:function(t,o){e.rtclUnblock(),alert("Uncaught Error.\n"+t.responseText)}})})}),!1}),t(document).on("click",".js-rtcl-field-remove",function(){if(confirm(t(this).data("message-confirm"))){var e=t(this).closest(".postbox"),o=parseInt(e.data("id"),10);o?t.ajax({url:ajaxurl,method:"POST",data:{action:"rtcl_edit_field_delete",id:o,__rtcl_wpnonce:rtcl_cfg.__rtcl_wpnonce},beforeSend:function(){e.rtclBlock()},success:function(o){e.rtclUnblock(),o.error?alert(o.msg):e.slideUp(function(){t(this).remove()})},error:function(t,o){e.rtclUnblock(),alert("Uncaught Error.\n"+t.responseText)}}):alert("Field id not selected")}return!1}),t(document).on("click",".rtcl-cfg-field .rtcl-select-options-wrap .rtcl-add-new-option",function(e){e.preventDefault();var o=t(this),n=o.parent(".rtcl-select-options-wrap"),l=t("table.rtcl-fields-field-value-options tbody",n),i=n.data("type")||"select",r=o.data("name"),c=t("<tr />"),s=Number(new Date),a=t("tr",l).length+1,d=r+"[default]",u="radio";return"checkbox"==i&&(d=r+"[default][]",u="checkbox"),c.append("<td class='num'><span class='js-types-sort-button hndle dashicons dashicons-menu'></span></td>"),c.append("<td><input type='text' name='"+r+"[choices]["+s+"][title]' value='Option title "+a+"' ></td>"),c.append("<td><input type='text' name='"+r+"[choices]["+s+"][value]' value='option-title-"+a+"' ></td>"),c.append("<td><input type='"+u+"' name='"+d+"' value='"+s+"' ></td>"),c.append("<td class='num'><span class='rtcl-delete-option dashicons dashicons-trash'></span></td>"),l.append(c),l.typesFieldOptionsSortable(),!1}),t(document).on("click",".rtcl-cfg-field .rtcl-select-options-wrap .rtcl-delete-option",function(e){(e.preventDefault(),confirm("Are you sure?"))&&t(this).parents("tr").remove();return!1}),t.fn.typesFieldOptionsSortable=function(){t(".rtcl-fields-radio-sortable, .rtcl-fields-select-sortable, .rtcl-fields-checkboxes-sortable",this).sortable({cursor:"ns-resize",axis:"y",handle:".js-types-sort-button",start:function(t,e){e.placeholder.height(e.item.height()-2)}}),t(".rtcl-fields-checkboxes-sortable",this).sortable({start:function(t,e){e.placeholder.height(e.item.height()+13)}})},t.fn.typesMarkExistingField=function(){var e=t(".rtcl-forms-field-slug",this);e.length&&""!=e.val()&&e.attr("data-types-existing-field",e.val())},t("body").typesFieldOptionsSortable(),e.on("keyup",".rtcl-forms-set-legend",function(){var e=t(this).val();e&&(e=(e=(e=(e=e.replace(/</,"&lt;")).replace(/>/,"&gt;")).replace(/'/,"&#39;")).replace(/"/,"&quot;")),t(this).parents(".postbox").find(".rtcl-legend-update").html(e)})}(jQuery),function(t){var e;function o(){t(".ui-dialog").each(function(){t(this).css({maxWidth:"100%",top:t(window).scrollTop()+50+"px",left:(t("body").innerWidth()-t(this).outerWidth())/2+"px"})})}t(document).on("dialogopen",".ui-dialog",function(e,o){t("button.button-primary, button.wpcf-ui-dialog-cancel").blur().addClass("button").removeClass("ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only")}),t(window).on("resize scroll",function(){clearTimeout(e),e=setTimeout(o,200)})}(jQuery);
